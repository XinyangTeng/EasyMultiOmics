% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/identify_minimal_change_units.R
\name{identify_minimal_change_units}
\alias{identify_minimal_change_units}
\title{Identify Minimal Change Units in Microbiome Data}
\usage{
identify_minimal_change_units(
  physeq,
  group_col,
  levels = c("Species", "Genus", "Family", "Order", "Class", "Phylum"),
  consist_thresh = 0.8,
  p_thresh = 0.05,
  abund_thresh = 0.001,
  use_fdr = TRUE,
  min_sub_units = 2,
  verbose = TRUE
)
}
\arguments{
\item{physeq}{A \code{phyloseq} object containing OTU table, taxonomy table, and sample data.}

\item{group_col}{Character string specifying the column name in sample data that contains
the grouping variable. Must be a binary factor with exactly 2 levels.}

\item{levels}{Character vector of taxonomic levels to analyze, ordered from most specific
to least specific. Default is \code{c("Species", "Genus", "Family", "Order", "Class", "Phylum")}.}

\item{consist_thresh}{Numeric value between 0 and 1 specifying the minimum proportion
of sub-units that must change in the same direction for consistency. Default is 0.8.}

\item{p_thresh}{Numeric value specifying the p-value threshold for statistical significance.
Default is 0.05.}

\item{abund_thresh}{Numeric value specifying the minimum mean relative abundance
threshold for filtering low-abundance taxa. Default is 0.001.}

\item{use_fdr}{Logical indicating whether to apply False Discovery Rate (FDR) correction.
Default is \code{TRUE}.}

\item{min_sub_units}{Integer specifying the minimum number of sub-units required
for analysis at each taxonomic level. Default is 2.}

\item{verbose}{Logical indicating whether to print progress messages. Default is \code{TRUE}.}
}
\value{
A data.frame containing the identified minimal change units with the following columns:
\describe{
  \item{Level}{Taxonomic level of the identified unit}
  \item{Taxon}{Name of the taxonomic unit}
  \item{Taxonomy_Path}{Full taxonomic path separated by "|"}
  \item{N_Sub_Units}{Number of sub-units within this taxonomic unit}
  \item{Consist_Prop}{Proportion of sub-units changing in the same direction}
  \item{Direction}{Direction of change ("Up_in_Group1" or "Down_in_Group1")}
  \item{P_Value}{P-value from Wilcoxon rank-sum test}
  \item{P_Value_FDR}{FDR-adjusted p-value (if use_fdr = TRUE)}
  \item{Upper_Consistency}{Logical indicating if upper taxonomic level also shows consistency}
  \item{Mean_LFC}{Mean log fold change across sub-units}
}
}
\description{
This function identifies taxonomic units that show consistent and significant
changes between two groups in microbiome data. It performs centered log-ratio (CLR)
transformation and identifies the most specific taxonomic level where changes occur.
}
\details{
The function performs the following steps:
\enumerate{
  \item Applies CLR transformation to the abundance data
  \item Filters low-abundance taxa based on \code{abund_thresh}
  \item For each taxonomic level, aggregates taxa and identifies sub-units
  \item Calculates consistency of change direction among sub-units
  \item Tests for statistical significance using Wilcoxon rank-sum test
  \item Identifies minimal change units by selecting the most specific taxonomic level
  \item Optionally applies FDR correction for multiple testing
}
}
\examples{
\dontrun{
# Load example data
data("GlobalPatterns", package = "phyloseq")

# Add binary grouping variable
sample_data(GlobalPatterns)$Treatment <- factor(
  sample(c("Control", "Treatment"), nsamples(GlobalPatterns), replace = TRUE)
)

# Run analysis
results <- identify_minimal_change_units(
  physeq = GlobalPatterns,
  group_col = "Treatment",
  consist_thresh = 0.8,
  p_thresh = 0.05
)

# View results
print(results)
}

}
\seealso{
\code{\link{plot_change_units}} for visualization of results
}
