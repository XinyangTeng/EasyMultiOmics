% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/namesame.R
\name{count_selection}
\alias{count_selection}
\title{Microbiome Feature Selection Analysis}
\usage{
count_selection(
  physeq,
  group_var,
  prevalence_threshold = 0.1,
  detection_threshold = 0.001,
  diff_method = c("DESeq2", "Wilcoxon"),
  ml_method = c("rf", "gbm", "boruta"),
  cor_method = c("spearman", "pearson"),
  cor_threshold = 0.6,
  p_threshold = 0.05,
  weights = list(abundance = 0.3, importance = 0.3, differential = 0.2, network = 0.2),
  nfolds = 5,
  ntree = 500
)
}
\arguments{
\item{physeq}{A phyloseq object containing the microbiome data}

\item{group_var}{Character string specifying the grouping variable in sample_data}

\item{prevalence_threshold}{Numeric, minimum prevalence threshold (default: 0.1)}

\item{detection_threshold}{Numeric, minimum detection threshold (default: 0.001)}

\item{diff_method}{Character, differential analysis method: "DESeq2" or "Wilcoxon" (default: "DESeq2")}

\item{ml_method}{Character, machine learning method: "rf", "gbm", or "boruta" (default: "rf")}

\item{cor_method}{Character, correlation method: "pearson" or "spearman" (default: "spearman")}

\item{cor_threshold}{Numeric, correlation threshold for network construction (default: 0.6)}

\item{p_threshold}{Numeric, p-value threshold for network edges (default: 0.05)}

\item{weights}{List, weights for each scoring component (default: balanced weights)}

\item{nfolds}{Integer, number of folds for cross-validation (default: 5)}

\item{ntree}{Integer, number of trees for random forest (default: 500)}
}
\value{
A list of class "microbiome_feature_selection" containing:
\describe{
  \item{final_ranking}{Data frame with summarized ranking results}
  \item{full_results}{Complete results with all metrics}
  \item{diff_results}{Differential abundance analysis results}
  \item{importance_results}{Machine learning importance scores}
  \item{network_results}{Network topology metrics}
  \item{abundance_results}{Abundance and prevalence statistics}
  \item{filtered_physeq}{Filtered phyloseq object used in analysis}
}
}
\description{
Performs comprehensive feature selection for microbiome data using multiple
approaches including differential abundance analysis, machine learning feature
importance, network analysis, and abundance patterns.
}
\examples{
\dontrun{
# Example workflow:
ps <- ps.16s \%>\% subset_samples(Group \%in\% c("WT","KO"))
ps <- ps \%>\% tax_glom("Genus")

res <- count_selection(ps,
                     group_var = "Group",
                     prevalence_threshold = 0.1,
                     detection_threshold = 0.001,
                     diff_method = "DESeq2",
                     ml_method = "rf",
                     cor_method = "spearman",
                     cor_threshold = 0.6,
                     p_threshold = 0.05,
                     weights = list(abundance = 0.3,
                                    importance = 0.3,
                                    differential = 0.2,
                                    network = 0.2))
top_features <- res$final_ranking \%>\% head(100)
}

}
