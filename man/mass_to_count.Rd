% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/namesame.R
\name{mass_to_count}
\alias{mass_to_count}
\title{MicrobeFinderFromMetabolite: find microbes associated with a target metabolite}
\usage{
mass_to_count(
  phyloseq_obj,
  metabolome_mat,
  target_metabolite_name,
  top_n = 30,
  cor_method = c("spearman", "pearson", "sparcc"),
  prevalence_threshold = 0.1,
  detection_threshold = 1e-04,
  use_clr = TRUE,
  group_split = c("median", "tertile", "quantile_0.4_0.6")
)
}
\arguments{
\item{phyloseq_obj}{phyloseq对象（微生物计数或相对丰度；建议原始计数）}

\item{metabolome_mat}{矩阵/数据框（样本×代谢物）}

\item{target_metabolite_name}{字符串：目标代谢物列名}

\item{top_n}{返回Top微生物数}

\item{cor_method}{相关方法："spearman"（默认，基于CLR）、"pearson"、"sparcc"（需 SpiecEasi）}

\item{prevalence_threshold}{微生物流行率阈值（默认0.1）}

\item{detection_threshold}{相对丰度检出阈值（默认1e-4；用于计算流行率）}

\item{use_clr}{是否对微生物做CLR（默认TRUE；DESeq2差异仍用原始计数）}

\item{group_split}{策略将代谢物分为High/Low：c("median","tertile","quantile_0.4_0.6")}
}
\value{
list：top_microbes, all_scores, correlation_results, network_metrics,
              diff_results, ml_results, aligned_data（样本对齐/变换后的数据）
\dontrun{
ps2 = ps.ms %>% subset_samples.wt("Group",c("WT","OE"))
tab = ps2 %>% vegan_otu() %>%
 as.data.frame()
ps = ps.16s %>% subset_samples.wt("Group",c("WT","OE")) %>% tax_glom_wt(6)
res <- mass_to_count(
  phyloseq_obj = GlobalPatterns,
  metabolome_mat = metabolome_data,
  target_metabolite_name = "Metabolite_X",
  top_n = 15,
  cor_method = "spearman"
)

head(res$top_features)
}
}
\description{
给定一个代谢物（非靶向代谢组矩阵中的一列），在 phyloseq 微生物数据中寻找潜在互作的微生物特征。
采用多维证据：相关（CLR/SparCC 可选）、网络中心性、差异丰度（代谢物高低分组）、机器学习
（用微生物预测该代谢物，得到微生物重要性），以及丰度/流行率优先。
}
\details{
依赖包可选：DESeq2（差异分析更稳），mixOmics（可做 PLS 回归 VIP），
igraph（网络）、glmnet / randomForest（机器学习）。没装会自动降级。
}
